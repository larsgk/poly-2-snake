<html><head><link rel="import" href="bower_components/polymer/polymer-element.html">
<link rel="import" href="singleton-mixin.html">
<link rel="import" href="bower_components/paper-button/paper-button.html">


</head><body><dom-module id="poly-snake">
  <template>
    <dom-repeat items="[[snake]]">
      <template>[[item.count]] - [[item.direction]]<br></template>
    </dom-repeat>
  </template>

  <script>

    class PolySnake extends Polymer.Element {
      static get is() { return 'poly-snake' }

      static get config() {
        return {
          properties: {
            snake: {
              type:Array,
              value: []
            }
          }
        };
      }

      connectedCallback() {
        super.connectedCallback();

        this.counter = 0;

        this.notifyPath('snake');

        let evtDetail = {
          value: this.snake,
          queueProperty: true,
          path: 'snake'
        }

        setInterval(_ => {
          this.snake.push(this.newPart(this.counter++));
          if(this.counter>=30)
            this.snake.splice(0,1);
          this.notifyPath('snake');
        }, 10);
      }

      newPart(count) {
        return {
          count: count,
          direction: count % 6,
          color: count % 4
        }
      }
    }

    customElements.define(PolySnake.is, PolySnake);

  </script>
</dom-module>
</body></html>